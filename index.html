<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="/public/cake.png" type="image/x-icon" />
    <link rel="icon" type="image/png" href="confetti.png" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css  "
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <style>
      /* Animasi jatuh */
      @keyframes fall {
        0% {
          transform: translateY(0) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(100vh) rotate(10deg);
          opacity: 0;
        }
      }

      .falling {
        animation: fall 1.5s ease-out forwards;
      }
    </style>

    <title>Happy Birthday</title>
  </head>
  <body>
    <div class="position-absolute top-50 start-50 translate-middle">
      <button
        id="button"
        class="btn btn-primary btn-lg"
        onclick="mulai();music()"
      >
        Click Here!
      </button>
      <div id="iloveyou" style="display: none">
        <h2 id="birthdayMessage" class="text-center">
          Happy Birthday <span id="birthdayName"></span>
        </h2>
        <h2 class="text-center">&#x1F389;</h2>
      </div>
    </div>
    <span
      id="hati"
      class="fixed-bottom text-center my-3"
      onclick="hati()"
    ></span>
    <audio id="bgMusic" src="selamatulangtahun2.mp3" loop></audio>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.all.min.js  "></script>
    <script type="text/javascript">
      const author = "Anagwer";
      document.getElementById(
        "hati"
      ).innerHTML = `Made with &#x1F381; by ${author}`;

      const swals = Swal.mixin({
        cancelButtonColor: "#d33",
        confirmButtonColor: "#3085d6",
      });

      let currentDialog = null;

      function stopMusic() {
        var audio = document.getElementById("bgMusic");
        audio.pause();
        audioPlaying = false;
      }

      // Fungsi reset ke awal
      function reset() {
        location.reload(); // Refresh halaman
      }

      // Fungsi untuk animasi typing
      function typeText(element, text, callback) {
        let i = 0;
        element.innerHTML = '';
        const timer = setInterval(() => {
          if (i < text.length) {
            element.innerHTML += text.charAt(i);
            i++;
          } else {
            clearInterval(timer);
            if (callback) callback();
          }
        }, 50); // Kecepatan typing, bisa diubah (ms)
      }

      async function mulai() {
        await swals.fire(
          "Halo!",
          "Karena ini hari yang istimewa buat u",
          "question"
        );
        await swals.fire("Aku mau ngucapin sesuatu nih ke kamu");

        var { value: nama } = await swals.fire({
          title: "Oh iya tulis nama kamu dulu di sini",
          input: "text",
        });

        if (!nama) {
          stopMusic();
          return;
        }

        document.getElementById("birthdayName").textContent = nama;
        var { isConfirmed: sayang } = await swals.fire({
          title: `${nama} hari ini ulang tahun ya?`,
          confirmButtonText: "Iya",
          cancelButtonText: "Ngak",
          showCancelButton: true,
        });

        if (!sayang) {
          // Tampilkan dialog kecewa dengan animasi typing
          const { html: dialogHtml } = await swals.fire({
            title: '<span id="typing-title">Aww... kok nggak sih ðŸ˜¢</span>',
            html: '<div id="typing-text">Jangan bohong deh, aku tahu ini hari spesial kamu kok!</div>',
            icon: "error",
            showConfirmButton: false,
            allowOutsideClick: false,
            allowEscapeKey: false,
            willOpen: () => {
              typeText(document.getElementById('typing-title'), 'Aww... kok nggak sih ðŸ˜¢', () => {
                // Callback setelah title selesai, bisa kosong atau tambahkan logika lain
              });
              typeText(document.getElementById('typing-text'), 'Jangan bohong deh, aku tahu ini hari spesial kamu kok!', () => {
                // Callback setelah teks selesai, bisa kosong atau tambahkan logika lain
              });
            }
          });

          // Tunggu sebentar sebelum menerapkan animasi runtuh
          setTimeout(() => {
            const dialogContainer = document.querySelector('.swal2-container');
            if (dialogContainer) {
              dialogContainer.classList.add('falling');
            }

            // Setelah animasi selesai, tampilkan tombol reset
            setTimeout(() => {
              swals.fire({
                title: "Yah kok bohong sih...",
                text: "Mau coba dari awal lagi?",
                showCancelButton: true,
                confirmButtonText: "Mulai Ulang",
                cancelButtonText: "Tutup",
              }).then((result) => {
                if (result.isConfirmed) {
                  reset();
                } else {
                  stopMusic();
                }
              });
            }, 1500); // Sesuaikan dengan durasi animasi CSS (1.5 detik)
          }, 2000); // Tunggu 2 detik setelah teks selesai muncul (1 detik teks + 1 detik jeda)

          return;
        }

        await swals.fire("Cie.. udah makin tua aja nih hehe");

        var { value: persen } = await swals.fire({
          title: "Hari ini kamu ulang tahun yang ke berapa?",
          icon: "question",
          input: "range",
          inputAttributes: {
            min: 1,
            max: 63,
          },
          inputValue: 10,
        });

        if (!persen) {
          stopMusic();
          return;
        }

        await swals.fire(
          `Selamat ya.. Semoga di umur yang ke ${persen} ini, Hari-hari kamu selalu di penuhi dengan kebahagiaan :)`
        );

        var { isConfirmed: kangen } = await swals.fire({
          title:
            "Dan semoga di tahun ini, apa yang kamu inginkan bisa terwujud",
          confirmButtonText: "Aamiin",
        });

        if (!kangen) {
          stopMusic();
          return;
        }

        await swals.fire(
          "Yauden aku cuma mau ngucapin itu aja, Sukses terus dan Sehat selalu :)"
        );
        await swals.fire(`Oh iya ${nama} terakhir nih`);
        await swals.fire("Coba klik ikon kado di paling bawah dong wkwkwk");
      }

      var audioPlaying = false;
      function music() {
        var audio = document.getElementById("bgMusic");
        if (!audioPlaying) audio.play();
        else audio.pause();
        audioPlaying = !audioPlaying;
      }

      function hati() {
        document.getElementById("button").style = "display: none";
        document.getElementById("iloveyou").style = "";
        startConfetti();
      }
    </script>

    <script
      type="text/javascript"
      src="https://www.cssscript.com/demo/confetti-falling-animation/confetti.js  "
    ></script>
  </body>
</html>
